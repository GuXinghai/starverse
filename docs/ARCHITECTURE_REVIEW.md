# Starverse ä»£ç æ¶æ„ä¸ä¸šåŠ¡åˆ†ç±»åˆ†ææŠ¥å‘Š

ç”Ÿæˆæ—¶é—´ï¼š2025-11-25

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

**æ€»ä½“è¯„ä»·ï¼šâ˜…â˜…â˜…â˜…â˜† (4/5)**

æ¶æ„æ•´ä½“æ¸…æ™°ï¼Œåˆ†å±‚åˆç†ï¼Œä½†å­˜åœ¨ä»¥ä¸‹éœ€è¦ä¼˜åŒ–çš„é—®é¢˜ï¼š
- âš ï¸ æ–‡ä»¶æ ¼å¼æ··ç”¨ï¼ˆ.js å’Œ .tsï¼‰å¯¼è‡´ç±»å‹å®‰å…¨ä¸ä¸€è‡´
- âš ï¸ éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘åˆ†æ•£åœ¨å¤šä¸ª Store ä¸­ï¼Œç¼ºä¹ç»Ÿä¸€ç®¡ç†
- âš ï¸ ç»„ä»¶ç²’åº¦ä¸å¤Ÿç»†åŒ–ï¼Œå­˜åœ¨ 1000+ è¡Œçš„å¤§ç»„ä»¶
- âš ï¸ æ–‡æ¡£æ•°é‡è¿‡å¤šï¼ˆ70+ ä¸ª .md æ–‡ä»¶ï¼‰ï¼Œç¼ºä¹ç»Ÿä¸€ç´¢å¼•

---

## ğŸ—ï¸ æ¶æ„åˆ†å±‚åˆ†æ

### 1. æ•´ä½“æ¶æ„è®¾è®¡ âœ… **ä¼˜ç§€**

é‡‡ç”¨å…¸å‹çš„ Electron ä¸‰å±‚æ¶æ„ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ¸²æŸ“è¿›ç¨‹ (Renderer Process)            â”‚
â”‚   - Vue 3 + Pinia + Tailwind CSS        â”‚
â”‚   - src/components/*.vue                â”‚
â”‚   - src/stores/*.{js,ts}                â”‚
â”‚   - src/services/*.{js,ts}              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ IPC Bridge (preload.ts)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä¸»è¿›ç¨‹ (Main Process)                  â”‚
â”‚   - electron/main.ts                    â”‚
â”‚   - electron/ipc/*.ts                   â”‚
â”‚   - electron/services/*.ts              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ Worker Threads
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Worker çº¿ç¨‹å±‚                          â”‚
â”‚   - electron/db/worker.ts               â”‚
â”‚   - SQLite Database (better-sqlite3)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜ç‚¹ï¼š**
- è¿›ç¨‹éš”ç¦»æ¸…æ™°ï¼Œå®‰å…¨æ€§å¥½
- æ•°æ®åº“æ“ä½œåœ¨ Worker çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä¸é˜»å¡ UI
- IPC ç™½åå•æœºåˆ¶é˜²æ­¢æ¸²æŸ“è¿›ç¨‹æ¶æ„è°ƒç”¨

---

## ğŸ“ ç›®å½•ç»“æ„åˆ†æ

### 2. æ¸²æŸ“è¿›ç¨‹ (src/) - âš ï¸ **éœ€è¦æ”¹è¿›**

#### 2.1 ç»„ä»¶å±‚ (`src/components/`)

**ç°çŠ¶ï¼š**
```
src/components/
â”œâ”€â”€ AdvancedModelPickerModal.vue  (360+ lines)
â”œâ”€â”€ AttachmentPreview.vue
â”œâ”€â”€ ChatTabs.vue
â”œâ”€â”€ ChatView.vue                   (1800+ lines) âš ï¸ è¿‡å¤§
â”œâ”€â”€ ContentRenderer.vue
â”œâ”€â”€ ConversationList.vue
â”œâ”€â”€ DeleteConfirmDialog.vue
â”œâ”€â”€ FavoriteModelSelector.vue
â”œâ”€â”€ MessageBranchController.vue
â”œâ”€â”€ ProjectHome.vue
â”œâ”€â”€ QuickModelSearch.vue
â”œâ”€â”€ SettingsView.vue
â”œâ”€â”€ TabbedChatView.vue
â””â”€â”€ (æ— å­ç›®å½•åˆ†ç±»)
```

**é—®é¢˜ï¼š**
1. âŒ **ç»„ä»¶è¿‡å¤§**ï¼š`ChatView.vue` è¶…è¿‡ 1800 è¡Œï¼Œè¿åå•ä¸€èŒè´£åŸåˆ™
2. âŒ **ç¼ºä¹åˆ†ç±»**ï¼šæ‰€æœ‰ç»„ä»¶å¹³é“ºåœ¨ä¸€ä¸ªç›®å½•ï¼Œéš¾ä»¥ç»´æŠ¤
3. âŒ **å‘½åä¸ä¸€è‡´**ï¼šæœ‰çš„ç”¨ `*View.vue`ï¼Œæœ‰çš„ç”¨ `*Modal.vue`ï¼Œæœ‰çš„ç”¨ `*Controller.vue`

**å»ºè®®é‡æ„ï¼š**
```
src/components/
â”œâ”€â”€ layout/              # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ AppLayout.vue
â”‚   â””â”€â”€ Sidebar.vue
â”œâ”€â”€ chat/                # èŠå¤©ç›¸å…³
â”‚   â”œâ”€â”€ ChatView/        # æ‹†åˆ† ChatView
â”‚   â”‚   â”œâ”€â”€ index.vue
â”‚   â”‚   â”œâ”€â”€ ChatInput.vue
â”‚   â”‚   â”œâ”€â”€ MessageList.vue
â”‚   â”‚   â”œâ”€â”€ MessageItem.vue
â”‚   â”‚   â””â”€â”€ StreamingIndicator.vue
â”‚   â”œâ”€â”€ ChatTabs.vue
â”‚   â”œâ”€â”€ ConversationList.vue
â”‚   â””â”€â”€ MessageBranchController.vue
â”œâ”€â”€ project/             # é¡¹ç›®ç®¡ç†
â”‚   â””â”€â”€ ProjectHome.vue
â”œâ”€â”€ settings/            # è®¾ç½®ç›¸å…³
â”‚   â””â”€â”€ SettingsView.vue
â”œâ”€â”€ model/               # æ¨¡å‹é€‰æ‹©å™¨
â”‚   â”œâ”€â”€ AdvancedModelPickerModal.vue
â”‚   â”œâ”€â”€ FavoriteModelSelector.vue
â”‚   â””â”€â”€ QuickModelSearch.vue
â”œâ”€â”€ common/              # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ AttachmentPreview.vue
â”‚   â”œâ”€â”€ ContentRenderer.vue
â”‚   â””â”€â”€ DeleteConfirmDialog.vue
â””â”€â”€ index.ts             # ç»Ÿä¸€å¯¼å‡º
```

#### 2.2 çŠ¶æ€ç®¡ç†å±‚ (`src/stores/`)

**ç°çŠ¶ï¼š**
```
src/stores/
â”œâ”€â”€ chatStore.js              (2500+ lines) âš ï¸ è¿‡å¤§ï¼Œæ ¼å¼ä¸ä¸€è‡´
â”œâ”€â”€ chatStore.d.ts            (ç±»å‹å®šä¹‰ç‹¬ç«‹)
â”œâ”€â”€ index.ts                  (appStoreï¼Œ255 lines) âœ…
â”œâ”€â”€ projectWorkspaceStore.ts  (âœ…)
â”œâ”€â”€ branchTreeHelpers.ts      (è¾…åŠ©å‡½æ•°)
â”œâ”€â”€ README.md
â””â”€â”€ CHAT_STORE_GUIDE.md
```

**é—®é¢˜ï¼š**
1. âŒ **ç±»å‹å®‰å…¨ä¸ä¸€è‡´**ï¼š`chatStore.js` ä½¿ç”¨ JS + å¤–éƒ¨ `.d.ts`ï¼Œè€Œå…¶ä»–ç”¨ TS
2. âŒ **Store è¿‡å¤§**ï¼š`chatStore.js` è¶…è¿‡ 2500 è¡Œï¼ŒèŒè´£è¿‡å¤š
3. âš ï¸ **è¾…åŠ©å‡½æ•°æ··æ‚**ï¼š`branchTreeHelpers.ts` åº”è¯¥ç§»åˆ° `utils/` æˆ–ç‹¬ç«‹æ¨¡å—

**chatStore èŒè´£åˆ†æï¼š**
```javascript
// å½“å‰ chatStore.js åŒ…å«çš„èŒè´£ï¼š
1. å¯¹è¯ç®¡ç†ï¼ˆCRUDï¼‰
2. æ¶ˆæ¯ç®¡ç†ï¼ˆæ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤ï¼‰
3. åˆ†æ”¯æ ‘ç®¡ç†ï¼ˆåˆ›å»ºåˆ†æ”¯ã€åˆ‡æ¢åˆ†æ”¯ã€åˆå¹¶ï¼‰
4. å¤šæ ‡ç­¾ç®¡ç†ï¼ˆæ ‡ç­¾é¡µåˆ‡æ¢ã€å…³é—­ï¼‰
5. æ¨¡å‹é…ç½®ï¼ˆæ¨¡å‹é€‰æ‹©ã€å‚æ•°è®¾ç½®ï¼‰
6. æ¶ˆæ¯æ¸²æŸ“ï¼ˆdisplayMessages è®¡ç®—ï¼‰
7. æŒä¹…åŒ–è°ƒåº¦ï¼ˆä¿å­˜ã€åŠ è½½ï¼‰
8. ç»Ÿè®¡ä¿¡æ¯ï¼ˆtoken è®¡æ•°ã€ä½¿ç”¨é‡ï¼‰
```

**å»ºè®®é‡æ„ï¼š**
```
src/stores/
â”œâ”€â”€ app.ts                    # å…¨å±€é…ç½®ï¼ˆAPI Keyã€Providerï¼‰
â”œâ”€â”€ conversation.ts           # å¯¹è¯ CRUDï¼ˆä» chatStore æ‹†åˆ†ï¼‰
â”œâ”€â”€ message.ts                # æ¶ˆæ¯ç®¡ç†ï¼ˆä» chatStore æ‹†åˆ†ï¼‰
â”œâ”€â”€ branch.ts                 # åˆ†æ”¯æ ‘ç®¡ç†ï¼ˆä» chatStore æ‹†åˆ†ï¼‰
â”œâ”€â”€ tab.ts                    # å¤šæ ‡ç­¾ç®¡ç†ï¼ˆä» chatStore æ‹†åˆ†ï¼‰
â”œâ”€â”€ model.ts                  # æ¨¡å‹é…ç½®ï¼ˆä» chatStore æ‹†åˆ†ï¼‰
â”œâ”€â”€ projectWorkspace.ts       # é¡¹ç›®å·¥ä½œåŒºï¼ˆä¿æŒä¸å˜ï¼‰
â”œâ”€â”€ helpers/
â”‚   â”œâ”€â”€ branchTree.ts         # åˆ†æ”¯æ ‘è¾…åŠ©å‡½æ•°
â”‚   â”œâ”€â”€ messageCache.ts       # æ¶ˆæ¯ç¼“å­˜
â”‚   â””â”€â”€ serialization.ts      # åºåˆ—åŒ–/ååºåˆ—åŒ–
â””â”€â”€ index.ts                  # ç»Ÿä¸€å¯¼å‡º
```

#### 2.3 æœåŠ¡å±‚ (`src/services/`)

**ç°çŠ¶ï¼š**
```
src/services/
â”œâ”€â”€ aiChatService.js          (JS æ ¼å¼) âš ï¸
â”œâ”€â”€ geminiService.js          (JS æ ¼å¼) âš ï¸
â”œâ”€â”€ chatPersistence.ts        (TS æ ¼å¼) âœ…
â”œâ”€â”€ projectPersistence.ts     (TS æ ¼å¼) âœ…
â”œâ”€â”€ projectWorkspaceService.ts âœ…
â”œâ”€â”€ searchDsl.ts              âœ…
â”œâ”€â”€ searchService.ts          âœ…
â”œâ”€â”€ IAIProvider.ts            (æ¥å£å®šä¹‰) âœ…
â”œâ”€â”€ providers/
â”‚   â”œâ”€â”€ GeminiService.js      (JS æ ¼å¼) âš ï¸
â”‚   â”œâ”€â”€ OpenRouterService.js  (JS æ ¼å¼) âš ï¸
â”‚   â””â”€â”€ OpenRouterService.d.ts
â””â”€â”€ db/
    â”œâ”€â”€ index.ts              (æ•°æ®åº“å°è£…) âœ…
    â””â”€â”€ types.ts              âœ…
```

**é—®é¢˜ï¼š**
1. âŒ **æ ¼å¼ä¸ä¸€è‡´**ï¼šAI æœåŠ¡ç”¨ JSï¼ŒæŒä¹…åŒ–æœåŠ¡ç”¨ TS
2. âš ï¸ **å‘½åå†²çª**ï¼š`geminiService.js` å’Œ `providers/GeminiService.js` åŠŸèƒ½é‡å¤ï¼Ÿ
3. âš ï¸ **ç±»å‹å®šä¹‰åˆ†ç¦»**ï¼š`.js` + `.d.ts` ç»´æŠ¤æˆæœ¬é«˜

**å»ºè®®ç»Ÿä¸€æ ¼å¼ï¼š**
```
src/services/
â”œâ”€â”€ ai/
â”‚   â”œâ”€â”€ aiChatService.ts      # ç»Ÿä¸€æ”¹ä¸º TS
â”‚   â”œâ”€â”€ IAIProvider.ts        # æ¥å£å®šä¹‰
â”‚   â””â”€â”€ providers/
â”‚       â”œâ”€â”€ gemini.ts         # ç»Ÿä¸€æ”¹ä¸º TS
â”‚       â””â”€â”€ openRouter.ts     # ç»Ÿä¸€æ”¹ä¸º TS
â”œâ”€â”€ persistence/
â”‚   â”œâ”€â”€ chat.ts               # é‡å‘½åä¸ºæ›´çŸ­çš„åç§°
â”‚   â””â”€â”€ project.ts
â”œâ”€â”€ search/
â”‚   â”œâ”€â”€ searchService.ts
â”‚   â””â”€â”€ searchDsl.ts
â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ index.ts
â”‚   â””â”€â”€ types.ts
â””â”€â”€ index.ts                   # ç»Ÿä¸€å¯¼å‡º
```

#### 2.4 ç±»å‹å®šä¹‰å±‚ (`src/types/`)

**ç°çŠ¶ï¼š**
```
src/types/
â”œâ”€â”€ chat.ts           (328 lines) âœ… å®Œæ•´çš„æ¶ˆæ¯ç±»å‹å®šä¹‰
â”œâ”€â”€ conversation.ts   âœ…
â””â”€â”€ electron.d.ts     âœ… Electron API ç±»å‹æ‰©å±•
```

**è¯„ä»·ï¼šâœ… è‰¯å¥½**
- ç±»å‹å®šä¹‰é›†ä¸­ï¼Œæ˜“äºç»´æŠ¤
- æ”¯æŒå¤šæ¨¡æ€æ¶ˆæ¯ï¼ˆæ–‡æœ¬ã€å›¾åƒã€æ–‡ä»¶ï¼‰
- ç±»å‹æ³¨é‡Šè¯¦ç»†

**å»ºè®®ï¼š**
- å¯ä»¥è€ƒè™‘æŒ‰æ¨¡å—è¿›ä¸€æ­¥æ‹†åˆ†ï¼ˆå¦‚ `message.ts`, `branch.ts`, `model.ts`ï¼‰

#### 2.5 å·¥å…·å‡½æ•°å±‚ (`src/utils/`)

**ç°çŠ¶ï¼š**
```
src/utils/
â”œâ”€â”€ electronBridge.ts       (Electron API å°è£…)
â”œâ”€â”€ ipcSanitizer.js         (IPC æ•°æ®æ¸…ç†) âš ï¸ JS æ ¼å¼
â””â”€â”€ ipcSanitizer.d.ts
```

**é—®é¢˜ï¼š**
1. âŒ **å·¥å…·å‡½æ•°è¿‡å°‘**ï¼šå¾ˆå¤šè¾…åŠ©é€»è¾‘åˆ†æ•£åœ¨ç»„ä»¶å’Œ Store ä¸­
2. âš ï¸ **æ ¼å¼ä¸ä¸€è‡´**ï¼š`ipcSanitizer` åº”æ”¹ä¸º TS

**å»ºè®®æ‰©å……ï¼š**
```
src/utils/
â”œâ”€â”€ electronBridge.ts
â”œâ”€â”€ ipcSanitizer.ts       # æ”¹ä¸º TS
â”œâ”€â”€ format.ts             # æ ¼å¼åŒ–å·¥å…·ï¼ˆæ—¥æœŸã€æ–‡ä»¶å¤§å°ç­‰ï¼‰
â”œâ”€â”€ validation.ts         # æ•°æ®éªŒè¯å·¥å…·
â”œâ”€â”€ markdown.ts           # Markdown æ¸²æŸ“è¾…åŠ©
â””â”€â”€ clipboard.ts          # å‰ªè´´æ¿æ“ä½œ
```

---

### 3. ä¸»è¿›ç¨‹å±‚ (electron/) - âœ… **ä¼˜ç§€**

**ç°çŠ¶ï¼š**
```
electron/
â”œâ”€â”€ main.ts               (518 lines, èŒè´£æ¸…æ™°) âœ…
â”œâ”€â”€ preload.ts            (æš´éœ²å®‰å…¨çš„ IPC API) âœ…
â”œâ”€â”€ ipc/
â”‚   â”œâ”€â”€ dbBridge.ts       (æ•°æ®åº“ IPC ç™½åå•) âœ…
â”‚   â””â”€â”€ openRouterBridge.ts (OpenRouter æµå¼å“åº”) âœ…
â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ workerManager.ts  (Worker çº¿ç¨‹ç®¡ç†) âœ…
â”‚   â””â”€â”€ worker.ts         (SQLite æ“ä½œ) âœ…
â”œâ”€â”€ services/
â”‚   â””â”€â”€ inappBrowser.ts   (å†…åµŒæµè§ˆå™¨) âœ…
â””â”€â”€ types/
```

**è¯„ä»·ï¼šâœ… æ¶æ„æ¸…æ™°ï¼ŒèŒè´£åˆ†æ˜**
- IPC æ¡¥æ¥å±‚æœ‰ç™½åå•ä¿æŠ¤
- æ•°æ®åº“æ“ä½œéš”ç¦»åœ¨ Worker çº¿ç¨‹
- æ³¨é‡Šè¯¦ç»†ï¼Œæ˜“äºç†è§£

**å°å»ºè®®ï¼š**
- `main.ts` 518 è¡Œç•¥é•¿ï¼Œå¯ä»¥è€ƒè™‘å°†çª—å£ç®¡ç†ã€èœå•æ ç­‰é€»è¾‘æ‹†åˆ†åˆ°ç‹¬ç«‹æ¨¡å—

---

## ğŸ” ä¸šåŠ¡åˆ†ç±»åˆ†æ

### 4. æ ¸å¿ƒä¸šåŠ¡æ¨¡å—è¯†åˆ«

æ ¹æ®ä»£ç åˆ†æï¼Œå¯è¯†åˆ«å‡ºä»¥ä¸‹æ ¸å¿ƒä¸šåŠ¡æ¨¡å—ï¼š

#### 4.1 å¯¹è¯ç®¡ç†æ¨¡å—
**èŒè´£ï¼š** å¯¹è¯ CRUDã€å¤šæ ‡ç­¾ç®¡ç†ã€å¯¹è¯å½’æ¡£
**æ¶‰åŠæ–‡ä»¶ï¼š**
- `src/stores/chatStore.js` (ä¸»é€»è¾‘)
- `src/components/ConversationList.vue`
- `src/components/ChatTabs.vue`
- `src/services/chatPersistence.ts`

#### 4.2 æ¶ˆæ¯ä¸åˆ†æ”¯æ ‘æ¨¡å—
**èŒè´£ï¼š** æ¶ˆæ¯å‘é€ã€åˆ†æ”¯åˆ›å»ºã€åˆ†æ”¯åˆ‡æ¢ã€å†å²å›æº¯
**æ¶‰åŠæ–‡ä»¶ï¼š**
- `src/stores/chatStore.js` (ä¸»é€»è¾‘)
- `src/stores/branchTreeHelpers.ts`
- `src/components/MessageBranchController.vue`
- `src/types/chat.ts`

#### 4.3 AI æä¾›å•†é›†æˆæ¨¡å—
**èŒè´£ï¼š** å¤š AI æä¾›å•†æ”¯æŒï¼ˆGeminiã€OpenRouterï¼‰ã€æµå¼å“åº”
**æ¶‰åŠæ–‡ä»¶ï¼š**
- `src/services/aiChatService.js`
- `src/services/providers/GeminiService.js`
- `src/services/providers/OpenRouterService.js`
- `electron/ipc/openRouterBridge.ts`

#### 4.4 æ¨¡å‹é€‰æ‹©å™¨æ¨¡å—
**èŒè´£ï¼š** æ¨¡å‹åˆ—è¡¨ã€æ¨¡å‹æœç´¢ã€æ”¶è—æ¨¡å‹ã€å¿«æ·é€‰æ‹©
**æ¶‰åŠæ–‡ä»¶ï¼š**
- `src/components/AdvancedModelPickerModal.vue`
- `src/components/FavoriteModelSelector.vue`
- `src/components/QuickModelSearch.vue`
- `src/stores/chatStore.js` (æ¨¡å‹é…ç½®éƒ¨åˆ†)

#### 4.5 é¡¹ç›®å·¥ä½œåŒºæ¨¡å—
**èŒè´£ï¼š** é¡¹ç›® CRUDã€æç¤ºè¯æ¨¡æ¿ã€é¡¹ç›®æ¦‚è¿°
**æ¶‰åŠæ–‡ä»¶ï¼š**
- `src/stores/projectWorkspaceStore.ts`
- `src/services/projectPersistence.ts`
- `src/services/projectWorkspaceService.ts`
- `src/components/ProjectHome.vue`

#### 4.6 æœç´¢æ¨¡å—
**èŒè´£ï¼š** å…¨æ–‡æœç´¢ã€DSL æŸ¥è¯¢è¯­è¨€
**æ¶‰åŠæ–‡ä»¶ï¼š**
- `src/services/searchService.ts`
- `src/services/searchDsl.ts`

#### 4.7 å†…å®¹æ¸²æŸ“æ¨¡å—
**èŒè´£ï¼š** Markdown æ¸²æŸ“ã€ä»£ç é«˜äº®ã€LaTeX å…¬å¼ã€é™„ä»¶é¢„è§ˆ
**æ¶‰åŠæ–‡ä»¶ï¼š**
- `src/components/ContentRenderer.vue`
- `src/components/AttachmentPreview.vue`

#### 4.8 è®¾ç½®ä¸é…ç½®æ¨¡å—
**èŒè´£ï¼š** API Key ç®¡ç†ã€Provider åˆ‡æ¢ã€ä¸»é¢˜è®¾ç½®
**æ¶‰åŠæ–‡ä»¶ï¼š**
- `src/stores/index.ts` (appStore)
- `src/components/SettingsView.vue`
- `electron/main.ts` (electron-store)

---

## ğŸ› å‘ç°çš„é—®é¢˜ä¸å»ºè®®

### ä¸¥é‡é—®é¢˜ ğŸ”´

#### 1. ç±»å‹å®‰å…¨ä¸ä¸€è‡´
**é—®é¢˜ï¼š** æ··ç”¨ `.js` å’Œ `.ts`ï¼Œå¯¼è‡´ï¼š
- ç±»å‹æ£€æŸ¥ä¸å®Œæ•´ï¼ˆ`.js` æ–‡ä»¶æ— ç±»å‹æ¨æ–­ï¼‰
- ç»´æŠ¤æˆæœ¬é«˜ï¼ˆ`.d.ts` æ–‡ä»¶éœ€è¦æ‰‹åŠ¨åŒæ­¥ï¼‰
- é‡æ„å›°éš¾ï¼ˆIDE æ— æ³•è‡ªåŠ¨é‡æ„ JS æ–‡ä»¶ï¼‰

**å½±å“æ–‡ä»¶ï¼š**
- `src/stores/chatStore.js` (2500+ lines)
- `src/services/aiChatService.js`
- `src/services/providers/*.js`
- `src/utils/ipcSanitizer.js`

**å»ºè®®ï¼š** ç»Ÿä¸€è¿ç§»åˆ° TypeScript

#### 2. ç»„ä»¶ç²’åº¦è¿‡ç²—
**é—®é¢˜ï¼š** `ChatView.vue` è¶…è¿‡ 1800 è¡Œï¼ŒåŒ…å«ï¼š
- æ¶ˆæ¯åˆ—è¡¨æ¸²æŸ“
- è¾“å…¥æ¡†ç®¡ç†
- æµå¼å“åº”å¤„ç†
- åˆ†æ”¯æ ‘æ§åˆ¶
- é™„ä»¶å¤„ç†
- é”™è¯¯å¤„ç†

**å½±å“ï¼š**
- éš¾ä»¥ç»´æŠ¤
- ä»£ç å¤ç”¨å›°éš¾
- æµ‹è¯•å›°éš¾
- åä½œå†²çªç‡é«˜

**å»ºè®®ï¼š** æ‹†åˆ†ä¸º 5-8 ä¸ªå­ç»„ä»¶ï¼ˆè§ 2.1 èŠ‚ï¼‰

#### 3. Store èŒè´£è¿‡å¤š
**é—®é¢˜ï¼š** `chatStore` åŒ…å« 8 å¤§ç±»èŒè´£ï¼ˆè§ 2.2 èŠ‚ï¼‰ï¼Œè¿åå•ä¸€èŒè´£åŸåˆ™

**å½±å“ï¼š**
- ä»£ç è€¦åˆåº¦é«˜
- éš¾ä»¥å•å…ƒæµ‹è¯•
- æ€§èƒ½ä¼˜åŒ–å›°éš¾ï¼ˆæ— æ³•ç‹¬ç«‹ä¼˜åŒ–æŸä¸ªåŠŸèƒ½ï¼‰

**å»ºè®®ï¼š** æ‹†åˆ†ä¸º 6 ä¸ªç‹¬ç«‹ Storeï¼ˆè§ 2.2 èŠ‚ï¼‰

---

### ä¸­ç­‰é—®é¢˜ ğŸŸ¡

#### 4. æ–‡æ¡£ç®¡ç†æ··ä¹±
**é—®é¢˜ï¼š** `docs/` ç›®å½•åŒ…å« 70+ ä¸ª Markdown æ–‡ä»¶ï¼Œç¼ºä¹åˆ†ç±»å’Œç´¢å¼•

**å½±å“ï¼š**
- éš¾ä»¥æ‰¾åˆ°ç›¸å…³æ–‡æ¡£
- æ–‡æ¡£å†…å®¹å¯èƒ½è¿‡æ—¶
- æ–°å¼€å‘è€…å­¦ä¹ æˆæœ¬é«˜

**å»ºè®®ï¼š**
```
docs/
â”œâ”€â”€ README.md                 # æ–‡æ¡£ç´¢å¼•ï¼ˆå¿…é¡»ï¼‰
â”œâ”€â”€ architecture/             # æ¶æ„è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ overview.md
â”‚   â”œâ”€â”€ electron-ipc.md
â”‚   â””â”€â”€ worker-threads.md
â”œâ”€â”€ features/                 # åŠŸèƒ½å®ç°æ–‡æ¡£
â”‚   â”œâ”€â”€ branch-tree.md
â”‚   â”œâ”€â”€ model-picker.md
â”‚   â””â”€â”€ ...
â”œâ”€â”€ optimization/             # æ€§èƒ½ä¼˜åŒ–æ–‡æ¡£
â”‚   â”œâ”€â”€ chat-switching.md
â”‚   â””â”€â”€ ...
â”œâ”€â”€ changelog/                # å˜æ›´è®°å½•
â”‚   â””â”€â”€ ...
â””â”€â”€ archived/                 # å·²å½’æ¡£çš„æ–‡æ¡£
    â””â”€â”€ ...
```

#### 5. æµ‹è¯•ä»£ç æ··å…¥ä¸»ç›®å½•
**é—®é¢˜ï¼š** æ ¹ç›®å½•åŒ…å«å¤§é‡ `test-*.js` æ–‡ä»¶ï¼ˆ15+ ä¸ªï¼‰

**å»ºè®®ï¼š** ç§»åŠ¨åˆ° `tests/` æˆ– `__tests__/` ç›®å½•

---

### è½»å¾®é—®é¢˜ ğŸŸ¢

#### 6. ç¼ºä¹ç»Ÿä¸€çš„å¯¼å‡ºå…¥å£
**é—®é¢˜ï¼š** ç»„ä»¶ã€æœåŠ¡ã€å·¥å…·å‡½æ•°åˆ†æ•£å¯¼å…¥

**å»ºè®®ï¼š** æ·»åŠ  `index.ts` ç»Ÿä¸€å¯¼å‡º
```typescript
// src/components/index.ts
export { default as ChatView } from './chat/ChatView'
export { default as ChatTabs } from './chat/ChatTabs'
// ...

// src/services/index.ts
export * from './ai'
export * from './persistence'
export * from './search'
```

#### 7. é…ç½®æ–‡ä»¶åˆ†æ•£
**é—®é¢˜ï¼š** Viteã€Tailwindã€TypeScriptã€Electron Builder é…ç½®åˆ†æ•£

**å»ºè®®ï¼š** è€ƒè™‘åˆ›å»º `config/` ç›®å½•ï¼ˆå¯é€‰ï¼‰

---

## ğŸ“Š ä»£ç è´¨é‡æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | è¯„çº§ |
|------|------|------|
| å¹³å‡ç»„ä»¶å¤§å° | ~400 lines | ğŸŸ¡ åå¤§ |
| æœ€å¤§ç»„ä»¶å¤§å° | 1800 lines | ğŸ”´ è¿‡å¤§ |
| å¹³å‡ Store å¤§å° | ~1000 lines | ğŸŸ¡ åå¤§ |
| æœ€å¤§ Store å¤§å° | 2500 lines | ğŸ”´ è¿‡å¤§ |
| TypeScript è¦†ç›–ç‡ | ~60% | ğŸŸ¡ ä¸­ç­‰ |
| æ³¨é‡Šè¦†ç›–ç‡ | é«˜ | ğŸŸ¢ ä¼˜ç§€ |
| æ¶æ„æ–‡æ¡£å®Œæ•´åº¦ | é«˜ | ğŸŸ¢ ä¼˜ç§€ |

---

## ğŸ¯ é‡æ„ä¼˜å…ˆçº§å»ºè®®

### é«˜ä¼˜å…ˆçº§ï¼ˆå»ºè®® 1-2 å‘¨å†…å®Œæˆï¼‰

1. **ç»Ÿä¸€ç±»å‹ç³»ç»Ÿ**
   - å°† `chatStore.js` è¿ç§»åˆ° `chatStore.ts`
   - å°† AI æœåŠ¡è¿ç§»åˆ° TypeScript
   - åˆ é™¤æ‰€æœ‰ `.d.ts` æ–‡ä»¶

2. **æ‹†åˆ† ChatView ç»„ä»¶**
   - æå– `MessageList.vue`
   - æå– `ChatInput.vue`
   - æå– `StreamingIndicator.vue`

### ä¸­ä¼˜å…ˆçº§ï¼ˆå»ºè®® 1 ä¸ªæœˆå†…å®Œæˆï¼‰

3. **æ‹†åˆ† chatStore**
   - æ‹†åˆ†ä¸º 6 ä¸ªç‹¬ç«‹ Store
   - ä¿ç•™å‘åå…¼å®¹çš„å¯¼å‡ºæ¥å£

4. **æ•´ç†æ–‡æ¡£ç›®å½•**
   - åˆ›å»ºåˆ†ç±»ç›®å½•
   - ç¼–å†™ `docs/README.md` ç´¢å¼•
   - å½’æ¡£è¿‡æ—¶æ–‡æ¡£

### ä½ä¼˜å…ˆçº§ï¼ˆå¯é•¿æœŸä¼˜åŒ–ï¼‰

5. **ç»„ä»¶åˆ†ç±»**
   - åˆ›å»ºå­ç›®å½•åˆ†ç±»
   - ç»Ÿä¸€ç»„ä»¶å‘½åè§„èŒƒ

6. **æ·»åŠ ç»Ÿä¸€å¯¼å‡º**
   - ä¸º componentsã€servicesã€utils æ·»åŠ  `index.ts`

---

## âœ… æ¶æ„äº®ç‚¹

1. **Worker çº¿ç¨‹éš”ç¦»** âœ…
   - æ•°æ®åº“æ“ä½œä¸é˜»å¡ UI
   - çº¿ç¨‹å®‰å…¨è®¾è®¡

2. **IPC ç™½åå•æœºåˆ¶** âœ…
   - é˜²æ­¢æ¸²æŸ“è¿›ç¨‹æ¶æ„è°ƒç”¨
   - å®‰å…¨æ€§é«˜

3. **æ³¨é‡Šå®Œæ•´** âœ…
   - ä¸»è¦æ¨¡å—éƒ½æœ‰è¯¦ç»†æ³¨é‡Š
   - æ˜“äºæ–°äººç†è§£

4. **åˆ†æ”¯æ ‘è®¾è®¡** âœ…
   - æ”¯æŒæ¶ˆæ¯å†å²å›æº¯
   - ç±»ä¼¼ Git åˆ†æ”¯çš„äº¤äº’ä½“éªŒ

5. **å¤š AI æä¾›å•†æ”¯æŒ** âœ…
   - ç»Ÿä¸€æ¥å£æŠ½è±¡
   - æ˜“äºæ‰©å±•æ–°æä¾›å•†

---

## ğŸ“ ç»“è®º

Starverse çš„æ•´ä½“æ¶æ„è®¾è®¡åˆç†ï¼Œåˆ†å±‚æ¸…æ™°ï¼Œå®‰å…¨æœºåˆ¶å®Œå–„ã€‚ä¸»è¦é—®é¢˜é›†ä¸­åœ¨ï¼š
1. ç±»å‹å®‰å…¨ä¸ä¸€è‡´ï¼ˆJS/TS æ··ç”¨ï¼‰
2. ç»„ä»¶å’Œ Store ç²’åº¦è¿‡ç²—
3. æ–‡æ¡£ç®¡ç†æ··ä¹±

å»ºè®®ä¼˜å…ˆå®Œæˆé«˜ä¼˜å…ˆçº§é‡æ„ä»»åŠ¡ï¼Œä»¥æå‡ä»£ç å¯ç»´æŠ¤æ€§å’Œç±»å‹å®‰å…¨ã€‚

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [CHAT_STORE_API.md](./CHAT_STORE_API.md) - ChatStore API æ–‡æ¡£
- [BRANCH_TREE_IMPLEMENTATION.md](./BRANCH_TREE_IMPLEMENTATION.md) - åˆ†æ”¯æ ‘å®ç°
- [CHAT_MULTITHREADING_PERFORMANCE_GUIDE.md](./CHAT_MULTITHREADING_PERFORMANCE_GUIDE.md) - æ€§èƒ½ä¼˜åŒ–æŒ‡å—
