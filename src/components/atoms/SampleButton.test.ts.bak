import { describe, it, expect } from 'vitest'
import { render, screen } from '@testing-library/vue'
import userEvent from '@testing-library/user-event'
import SampleButton from './SampleButton.vue'

describe('SampleButton', () => {
  it('renders with default props', () => {
    render(SampleButton, {
      slots: {
        default: 'Click me'
      }
    })
    
    const button = screen.getByRole('button', { name: 'Click me' })
    expect(button).toBeInTheDocument()
    expect(button).not.toBeDisabled()
  })

  it('applies primary variant classes by default', () => {
    render(SampleButton, {
      slots: {
        default: 'Primary'
      }
    })
    
    const button = screen.getByRole('button')
    expect(button).toHaveClass('bg-primary-600')
  })

  it('applies secondary variant classes', () => {
    render(SampleButton, {
      props: {
        variant: 'secondary'
      },
      slots: {
        default: 'Secondary'
      }
    })
    
    const button = screen.getByRole('button')
    expect(button).toHaveClass('bg-secondary-600')
  })

  it('applies outline variant classes', () => {
    render(SampleButton, {
      props: {
        variant: 'outline'
      },
      slots: {
        default: 'Outline'
      }
    })
    
    const button = screen.getByRole('button')
    expect(button).toHaveClass('border-2', 'border-primary-600')
  })

  it('applies small size classes', () => {
    render(SampleButton, {
      props: {
        size: 'sm'
      },
      slots: {
        default: 'Small'
      }
    })
    
    const button = screen.getByRole('button')
    expect(button).toHaveClass('px-3', 'py-1.5', 'text-sm')
  })

  it('applies large size classes', () => {
    render(SampleButton, {
      props: {
        size: 'lg'
      },
      slots: {
        default: 'Large'
      }
    })
    
    const button = screen.getByRole('button')
    expect(button).toHaveClass('px-6', 'py-3', 'text-lg')
  })

  it('can be disabled', () => {
    render(SampleButton, {
      props: {
        disabled: true
      },
      slots: {
        default: 'Disabled'
      }
    })
    
    const button = screen.getByRole('button')
    expect(button).toBeDisabled()
    expect(button).toHaveClass('opacity-50', 'cursor-not-allowed')
  })

  it('emits click event when clicked', async () => {
    const user = userEvent.setup()
    let clickCount = 0
    
    render(SampleButton, {
      props: {
        onClick: () => clickCount++
      },
      slots: {
        default: 'Click me'
      }
    })
    
    const button = screen.getByRole('button')
    await user.click(button)
    
    expect(clickCount).toBe(1)
  })

  it('does not emit click when disabled', async () => {
    const user = userEvent.setup()
    let clickCount = 0
    
    render(SampleButton, {
      props: {
        disabled: true,
        onClick: () => clickCount++
      },
      slots: {
        default: 'Disabled'
      }
    })
    
    const button = screen.getByRole('button')
    await user.click(button)
    
    expect(clickCount).toBe(0)
  })
})
